---
layout: post
title: Quick and dirty way of checking links
date: 2015-03-13 09:34:49.000000000 +03:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories: []
tags: []
meta:
  _wpas_skip_facebook: '1'
  _wpas_skip_google_plus: '1'
  _wpas_skip_twitter: '1'
  _wpas_skip_linkedin: '1'
  _wpas_skip_tumblr: '1'
  _wpas_skip_path: '1'
  _publicize_pending: '1'
  _rest_api_published: '1'
  _rest_api_client_id: "-1"
author:
  login: eosfor
  email: eosfor@gmail.com
  display_name: eosfor
  first_name: ''
  last_name: ''
---
<p>So ho can we run through the site and check if links are ok on it? I mean if it is possible to automate this using powershell? Another thing here is how to do this fast, better in parallel threads. The problem here is that there is no threads in Powershell unfortunately. Thre are only Powershell Jobs, but they are quite heavy. So what to do and how to achive this? I've taken the idea from <a title="PS runspaces" href="http://learn-powershell.net/2012/05/13/using-background-runspaces-instead-of-psjobs-for-better-performance/">this</a> post. In general i run <a title="Invoke-WebRequest" href="https://technet.microsoft.com/en-us/library/hh849901.aspx">Invoke-WebRequest</a> cmdlet as a scriptblock in separate parallel runspaces. <a href="https://github.com/eosfor/Powershell-Tips/blob/master/TestSite.ps1">Here</a> you can have a look. My contribution in this is not very big. I've just updated the scriptblock running as part of the thread like below:</p>
<p>[sourcecode language="Powershell"]<br />
$ScriptBlock = {<br />
Param ($lnk)</p>
<p>$progressOld = $ProgressPreference<br />
$ProgressPreference=’SilentlyContinue’<br />
$obj = new-object psobject -prop @{Name = $lnk;<br />
Status = (Invoke-WebRequest -Uri $lnk -DisableKeep).statuscode}</p>
<p>$ProgressPreference = $progressOld<br />
$obj<br />
}<br />
[/sourcecode]</p>
<p>Also i've added some checks to skip repeating links and links that does not start from "http*"</p>
